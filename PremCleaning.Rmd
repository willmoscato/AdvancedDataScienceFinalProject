---
title: "FinalProject"
author: "Will Moscato"
date: "4/13/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(dplyr)
library(tidymodels)
library(lubridate)
```


```{r}
fifa17 <- read.csv("fut_bin17_players.csv")
fifa18 <- read.csv("fut_bin18_players.csv")
fifa19 <- read.csv("fut_bin19_players.csv")
premnames17 <- read.csv("16_17_premnames.csv")
premnames18 <- read.csv("17_18_premnames.csv")
premnames19 <- read.csv("18_19_premnames.csv")
standardprem17 <- read.csv("standardprem17.csv")
standardprem18 <- read.csv("standardprem18.csv")
standardprem19 <- read.csv("standardprem19.csv")
premtable17 <- read.csv("premtable17.csv")
```


```{r}
fifa17_clean <- fifa17 %>% 
  filter(revision %in% c("Normal", "TOTS")) %>%
  arrange(desc(overall)) %>% 
  distinct(player_extended_name, .keep_all = TRUE)
```

```{r}
fifa18_clean <- fifa18 %>% 
  filter(revision %in% c("Normal", "TOTS")) %>%
  arrange(desc(overall)) %>% 
  distinct(player_extended_name, .keep_all = TRUE)
```


```{r}
fifa19_clean <- fifa19 %>% 
  filter(revision %in% c("Normal", "TOTS")) %>%
  arrange(desc(overall)) %>% 
  distinct(player_extended_name, .keep_all = TRUE)
```


```{r}
fifa17_names <- fifa17_clean %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã€", "A")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã‰", "E")) %>%  
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã©", "e")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã¨", "e")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã¡", "a")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã", "A")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Å¡", "s")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã«", "e")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã¶", "o")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i³", "o")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã", "i")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "°", "d")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "iº", "u")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i£", "a")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i¼", "u")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Å", "S")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã¼", "u")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i–", "O")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i³", "o")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i½", "y")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i¯", "i")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i®", "i")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ä", "c")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã€", "A")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã‰", "E")) %>%  
  mutate(player_name = str_replace_all(player_name, "Ã©", "e")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã¨", "e")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã¡", "a")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã", "A")) %>% 
  mutate(player_name = str_replace_all(player_name, "Å¡", "s")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã«", "e")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã¶", "o")) %>% 
  mutate(player_name = str_replace_all(player_name, "i³", "o")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã", "i")) %>% 
  mutate(player_name = str_replace_all(player_name, "°", "d")) %>% 
  mutate(player_name = str_replace_all(player_name, "iº", "u")) %>% 
  mutate(player_name = str_replace_all(player_name, "i£", "a")) %>% 
  mutate(player_name = str_replace_all(player_name, "i¼", "u")) %>% 
  mutate(player_name = str_replace_all(player_name, "Å", "S")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã¼", "u")) %>% 
  mutate(player_name = str_replace_all(player_name, "i–", "O")) %>% 
  mutate(player_name = str_replace_all(player_name, "i³", "o")) %>% 
  mutate(player_name = str_replace_all(player_name, "i½", "y")) %>% 
  mutate(player_name = str_replace_all(player_name, "i¯", "i")) %>% 
  mutate(player_name = str_replace_all(player_name, "i®", "i")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ä", "c"))
```


```{r}
fifa18_names <- fifa18_clean %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã€", "A")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã‰", "E")) %>%  
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã©", "e")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã¨", "e")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã¡", "a")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã", "A")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Å¡", "s")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã«", "e")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã¶", "o")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i³", "o")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã", "i")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "°", "d")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "iº", "u")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i£", "a")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i¼", "u")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Å", "S")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã¼", "u")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i–", "O")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i³", "o")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i½", "y")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i¯", "i")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i®", "i")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ä", "c")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã€", "A")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã‰", "E")) %>%  
  mutate(player_name = str_replace_all(player_name, "Ã©", "e")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã¨", "e")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã¡", "a")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã", "A")) %>% 
  mutate(player_name = str_replace_all(player_name, "Å¡", "s")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã«", "e")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã¶", "o")) %>% 
  mutate(player_name = str_replace_all(player_name, "i³", "o")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã", "i")) %>% 
  mutate(player_name = str_replace_all(player_name, "°", "d")) %>% 
  mutate(player_name = str_replace_all(player_name, "iº", "u")) %>% 
  mutate(player_name = str_replace_all(player_name, "i£", "a")) %>% 
  mutate(player_name = str_replace_all(player_name, "i¼", "u")) %>% 
  mutate(player_name = str_replace_all(player_name, "Å", "S")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã¼", "u")) %>% 
  mutate(player_name = str_replace_all(player_name, "i–", "O")) %>% 
  mutate(player_name = str_replace_all(player_name, "i³", "o")) %>% 
  mutate(player_name = str_replace_all(player_name, "i½", "y")) %>% 
  mutate(player_name = str_replace_all(player_name, "i¯", "i")) %>% 
  mutate(player_name = str_replace_all(player_name, "i®", "i")) %>% 
   mutate(player_name = str_replace_all(player_name, "Ä", "c"))
```


```{r}
fifa19_names <- fifa19_clean %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã€", "A")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã‰", "E")) %>%  
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã©", "e")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã¨", "e")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã¡", "a")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã", "A")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Å¡", "s")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã«", "e")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã¶", "o")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i³", "o")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã", "i")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "°", "d")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "iº", "u")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i£", "a")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i¼", "u")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Å", "S")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ã¼", "u")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i–", "O")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i³", "o")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i½", "y")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i¯", "i")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "i®", "i")) %>% 
  mutate(player_extended_name = str_replace_all(player_extended_name, "Ä", "c")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã€", "A")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã‰", "E")) %>%  
  mutate(player_name = str_replace_all(player_name, "Ã©", "e")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã¨", "e")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã¡", "a")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã", "A")) %>% 
  mutate(player_name = str_replace_all(player_name, "Å¡", "s")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã«", "e")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã¶", "o")) %>% 
  mutate(player_name = str_replace_all(player_name, "i³", "o")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã", "i")) %>% 
  mutate(player_name = str_replace_all(player_name, "°", "d")) %>% 
  mutate(player_name = str_replace_all(player_name, "iº", "u")) %>% 
  mutate(player_name = str_replace_all(player_name, "i£", "a")) %>% 
  mutate(player_name = str_replace_all(player_name, "i¼", "u")) %>% 
  mutate(player_name = str_replace_all(player_name, "Å", "S")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ã¼", "u")) %>% 
  mutate(player_name = str_replace_all(player_name, "i–", "O")) %>% 
  mutate(player_name = str_replace_all(player_name, "i³", "o")) %>% 
  mutate(player_name = str_replace_all(player_name, "i½", "y")) %>% 
  mutate(player_name = str_replace_all(player_name, "i¯", "i")) %>% 
  mutate(player_name = str_replace_all(player_name, "i®", "i")) %>% 
  mutate(player_name = str_replace_all(player_name, "Ä", "c"))
```


##17

```{r}
premnames17 <-premnames17 %>% 
  mutate(Player1 = gsub(".*\\\\", "", Player)) %>% 
  mutate(Player = str_replace_all(Player1, "-", " "))
```


```{r}
prem17_names <- fifa17_names %>% 
  filter(league == "Premier League") %>% 
  select(player_name, player_extended_name, overall, revision, position)
```



```{r}
prem17 <- premnames17 %>%
  inner_join(prem17_names, by = c("Player" = "player_extended_name")) %>% 
  select(-Player1, -player_name)
```


```{r}
missing17 <- premnames17 %>%
  left_join(prem17_names, by = c("Player" = "player_extended_name")) %>% 
  filter(is.na(player_name) == TRUE)
```





```{r}
not_missing_17 <- missing %>% 
  select(-overall, -revision) %>% 
  left_join(prem16_names, by = c("Player" = "player_name")) 
```


```{r}

last_names17 <- not_missing_17 %>% 
  filter(is.na(overall) == TRUE) %>% 
  mutate(Player_short =  gsub(".* ", "", Player)) %>% 
  mutate(Player_short = ifelse(Player_short == "Aanholt", "Van Aanholt", ifelse(Player_short == "Dijk", "Van Dijk", ifelse(Player_short == "min", "Son", ifelse(Player_short == "Prowse", "Ward-Prowse", ifelse(Player_short == "yueng", "Ki Sung Yueng", ifelse(Player_short == "yong", "Lee Chung Yong", ifelse(Player_short == "Cheek", "Loftus-Cheek", ifelse(Player_short == "Chamberlain", "Oxlade-Chamberlain", ifelse(Player_short == "Gea", "De Gea", ifelse(Player_short == "Traore", "Adama", Player_short))))))))))) %>% 
  select(-player_name, -player_extended_name, -overall, -revision, - Player1)

not_real_name17 <- not_missing_17 %>% 
  filter(is.na(overall) == FALSE) %>% 
  select(-Player1, -player_name, -player_extended_name)
```


```{r}
weird_names17 <- last_names17 %>% 
  inner_join(prem17_names, by = c("Player_short" = "player_name")) %>% 
  select(-Player_short, -player_extended_name)
```

```{r}
fifa17_prem_full <- prem17 %>%
  bind_rows(not_real_name17, weird_names17) %>% 
  distinct(Player, .keep_all = TRUE) %>% 
  select(Player, revision, position, Int, TklW, OG, PKcon)
```


```{r}
standardprem17 <- standardprem17 %>% 
  mutate(Player1 = gsub(".*\\\\", "", Player)) %>% 
  mutate(Player = str_replace_all(Player1, "-", " "))
```

```{r}
fifa17_prem_standard_stats <- fifa17_prem_full %>% 
  inner_join(standardprem17, by = "Player") %>% 
  select(-Player1, -Pos) %>% 
  distinct(Player, .keep_all = TRUE)
```

##18


```{r}
premnames18 <-premnames18 %>% 
  mutate(Player1 = gsub(".*\\\\", "", Player)) %>% 
  mutate(Player = str_replace_all(Player1, "-", " "))
```


```{r}
prem18_names <- fifa18_names %>% 
  filter(league == "Premier League") %>% 
  select(player_name, player_extended_name, overall, revision, position)
```



```{r}
prem18 <- premnames18 %>%
  inner_join(prem18_names, by = c("Player" = "player_extended_name")) %>% 
  select(-Player1, -player_name)
```


```{r}
missing18 <- premnames18 %>%
  left_join(prem18_names, by = c("Player" = "player_extended_name")) %>% 
  filter(is.na(player_name) == TRUE)
```





```{r}
not_missing_18 <- missing %>% 
  select(-overall, -revision) %>% 
  left_join(prem18_names, by = c("Player" = "player_name")) 
```


```{r}

last_names18 <- not_missing_18 %>% 
  filter(is.na(overall) == TRUE) %>% 
  mutate(Player_short =  gsub(".* ", "", Player)) %>% 
  mutate(Player_short = ifelse(Player_short == "Aanholt", "Van Aanholt", ifelse(Player_short == "Dijk", "Van Dijk", ifelse(Player_short == "min", "Son", ifelse(Player_short == "Prowse", "Ward-Prowse", ifelse(Player_short == "yueng", "Ki Sung Yueng", ifelse(Player_short == "yong", "Lee Chung Yong", ifelse(Player_short == "Cheek", "Loftus-Cheek", ifelse(Player_short == "Chamberlain", "Oxlade-Chamberlain", ifelse(Player_short == "Gea", "De Gea", ifelse(Player_short == "Ginkel", "Van Ginkel", ifelse(Player_short == "Traore", "Adama", Player_short)))))))))))) %>% 
  select(-player_name, -player_extended_name, -overall, -revision, - Player1)

not_real_name18 <- not_missing_18 %>% 
  filter(is.na(overall) == FALSE) %>% 
  select(-Player1, -player_name, -player_extended_name)
```


```{r}
weird_names18 <- last_names18 %>% 
  inner_join(prem18_names, by = c("Player_short" = "player_name")) %>% 
  select(-Player_short, -player_extended_name)
```

```{r}
fifa18_prem_full <- prem18 %>%
  bind_rows(not_real_name18, weird_names18) %>% 
  distinct(Player, .keep_all = TRUE) %>% 
  select(Player, revision, position, Int, TklW, OG, PKcon)
```


```{r}
standardprem18 <- standardprem18 %>% 
  mutate(Player1 = gsub(".*\\\\", "", Player)) %>% 
  mutate(Player = str_replace_all(Player1, "-", " "))
```

```{r}
fifa18_prem_standard_stats <- fifa18_prem_full %>% 
  inner_join(standardprem18, by = "Player") %>% 
  select(-Player1, -Pos) %>% 
  distinct(Player, .keep_all = TRUE)
```


##19
```{r}
premnames19 <-premnames19 %>% 
  mutate(Player1 = gsub(".*\\\\", "", Player)) %>% 
  mutate(Player = str_replace_all(Player1, "-", " "))
```


```{r}
prem19_names <- fifa19_names %>% 
  filter(league == "Premier League") %>% 
  select(player_name, player_extended_name, overall, revision, position)
```



```{r}
prem19 <- premnames19 %>%
  inner_join(prem19_names, by = c("Player" = "player_extended_name")) %>% 
  select(-Player1, -player_name)
```


```{r}
missing19 <- premnames19 %>%
  left_join(prem19_names, by = c("Player" = "player_extended_name")) %>% 
  filter(is.na(player_name) == TRUE)
```





```{r}
not_missing_19 <- missing %>% 
  select(-overall, -revision) %>% 
  left_join(prem19_names, by = c("Player" = "player_name")) 
```


```{r}

last_names19 <- not_missing_19 %>% 
  filter(is.na(overall) == TRUE) %>% 
  mutate(Player_short =  gsub(".* ", "", Player)) %>% 
  mutate(Player_short = ifelse(Player_short == "Aanholt", "Van Aanholt", ifelse(Player_short == "Dijk", "Van Dijk", ifelse(Player_short == "min", "Son", ifelse(Player_short == "Prowse", "Ward-Prowse", ifelse(Player_short == "yueng", "Ki Sung Yueng", ifelse(Player_short == "yong", "Lee Chung Yong", ifelse(Player_short == "Cheek", "Loftus-Cheek", ifelse(Player_short == "Chamberlain", "Oxlade-Chamberlain", ifelse(Player_short == "Gea", "De Gea", ifelse(Player_short == "Ginkel", "Van Ginkel", ifelse(Player_short == "Traore", "Adama", Player_short)))))))))))) %>% 
  select(-player_name, -player_extended_name, -overall, -revision, - Player1)

not_real_name19 <- not_missing_19 %>% 
  filter(is.na(overall) == FALSE) %>% 
  select(-Player1, -player_name, -player_extended_name)
```


```{r}
weird_names19 <- last_names19 %>% 
  inner_join(prem19_names, by = c("Player_short" = "player_name")) %>% 
  select(-Player_short, -player_extended_name)
```

```{r}
fifa19_prem_full <- prem19 %>%
  bind_rows(not_real_name19, weird_names19) %>% 
  distinct(Player, .keep_all = TRUE) %>% 
  select(Player, revision, position, Int, TklW, OG, PKcon)
```


```{r}
standardprem19 <- standardprem19 %>% 
  mutate(Player1 = gsub(".*\\\\", "", Player)) %>% 
  mutate(Player = str_replace_all(Player1, "-", " "))
```

```{r}
fifa19_prem_standard_stats <- fifa19_prem_full %>% 
  inner_join(standardprem19, by = "Player") %>% 
  select(-Player1, -Pos) %>% 
  distinct(Player, .keep_all = TRUE)
```

```{r}

```


































